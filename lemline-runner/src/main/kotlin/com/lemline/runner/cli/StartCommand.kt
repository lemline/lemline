// SPDX-License-Identifier: BUSL-1.1
package com.lemline.runner.cli

import io.quarkus.arc.Unremovable
import io.quarkus.runtime.Quarkus
import jakarta.enterprise.context.Dependent
import picocli.CommandLine.Command
import picocli.CommandLine.Option

@Command(
    name = "start",
    description = ["Start the Lemline server in daemon mode"],
    mixinStandardHelpOptions = true
)
@Unremovable
@Dependent
class StartCommand : Runnable {

    @Option(
        names = ["-m", "--mascot"],
        description = ["Display the Lemline mascot on startup."],
        defaultValue = "true"
        )
    var mascot: Boolean = false

    override fun run() {
        if (mascot) {
            println(
                """

                       %%%                         @%%
                      %*****%%%                    %***%%
                      %********=%%                %******%%
                      %****#%*****@%              %********%
                      %*****%#%+++++@%            %*********%
                      %%****#%%*%+++++@%@%%%%%%%%%%@%@*******%
                       %*****%##%%=+++++%++++++++++++++*%%****%
                        %*****#%##%-+++++=+++++++++++++++++@%*@@
                        @%*****%#%%@++++++++++++++++++++++++++%%
                         *%****#*@++++++++++++++++++++++++++++++%
                           @%*##@+++%@+******==+=:%@%%@%%%@@%%@=*+=%
                             @%%@@=%***%%%%%%%%%%%%%%%%%%%%%%%%%%%%+%
                             %#%%##%**@%%%%%%%:@%%%%%%%%%%%%%%%%%%%*%
                           %%@*%#%#@**%%%@%%%::.:%%@%%%%%@%%%@...%@*%
           ::::              %%@%%%%**%%%%%%%::::*@%%%@%%%%@%%: :%%*%
                    ::::      %****@@**%%%%%%@:::%%%%%%%@%%%%%::%%@*%
                              @%****+%***%%%%%%%%%%%%@%%*******%%%*%
        ::::                   @%**+%.:@%@+***%%%%@%**@@@......%%%@ %
      :::: :::       :::-        %@#*-.....: %%@@%%%@......%%%%%...@@
     :::     ::               %%%*#%%*#....................@%%@...:%
     :::     ::            %%*+**+*++**#**.......................%%
      :::  :::           %@+*+*++++*+*+*******:...............@%@
        ::::           %@*++*++++*++++*+*+****.::::::::@%%%@@
       :-            @%++**++++*++*+++*++=****......:::::%***%%
       @==          %%**++++**=++++++*+***%*%...........@%******%@
        ++         %@***++*+++++@++++**+++*@@..........%%*********%
         @*%*     %%*++++*++**++*+%+*++**+*+%@........%%%%%*******%%
          %%****##%**+**++++*++*++**%%@++*+*=%......:%
             %%%%%***++***+++*+******.::@%%%@......%%
                %#*++*+*++**+*++%*:::::::::.....:%%
              %%***#**+**++***%::::::::: ..:::%%#
             %******%%@*%%%%%%@%:::::::: %%%%
            %*****%@       %%%%%##%%%
           %%#@%%        *%%%###%%
                         %@@%%@
            """.trimIndent()
            )
        }

        Quarkus.waitForExit()
    }
}
